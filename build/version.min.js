var Version=function(){"use strict";function e(e){var t="";return 1===e.length?t=e[0]:2===e.length?t=e.join(" and "):e.length>2&&(t=e.slice(0,-1).join(", ")+", and "+e.slice(-1)),t}var t=function(e,t){return t={exports:{}},e(t,t.exports),t.exports}(function(e){var t=function(){};t.prototype={bind:function(e,t){this._events=this._events||{},this._events[e]=this._events[e]||[],this._events[e].push(t)},unbind:function(e,t){this._events=this._events||{},e in this._events!=!1&&this._events[e].splice(this._events[e].indexOf(t),1)},trigger:function(e){if(this._events=this._events||{},e in this._events!=!1)for(var t=0;t<this._events[e].length;t++)this._events[e][t].apply(this,Array.prototype.slice.call(arguments,1))}},t.mixin=function(e){for(var n=["bind","unbind","trigger"],r=0;r<n.length;r++)e.prototype[n[r]]=t.prototype[n[r]]},"exports"in e&&(e.exports=t)}),n=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)},r=window.__version_base_url||"http://staging.api.releasepage.co",i=window.__help_base_url||"https://help.releasepage.co/api/getting-started",s=function(e){this.options=e};return s.prototype={load:function(){var e=this.onLoad.bind(this),t=new XMLHttpRequest;t.addEventListener("load",function(){e({status:this.status,response:this.response})});var n=r+"/v1/pages/"+this.options.page+"/version?apiKey="+this.options.apiKey;t.open("GET",n),t.send()},onLoad:function(e){var t=e.status,n=e.response;switch(t){case 404:return console.error("version.js: A page by name "+this.options.page);case 401:console.error("version.js: enable the version api for this page: "+i);break;case 200:var r=JSON.parse(n);this.latest=r.latest,this.latestGrouped=r.latestGrouped,this.permalink=r.permalink;break;default:return console.error("version.js: ReleasePage API error",t)}var s=document.querySelectorAll("[data-version-badge]");s.length&&this.renderBadges({elements:s});var o=document.querySelectorAll("[data-repo-name]");o.length&&this.renderRepoNames({elements:o});var a=document.querySelectorAll("[data-version-author]");a.length&&this.renderAuthors({elements:a});var u=document.querySelectorAll("[data-version-published]");return u.length&&this.renderPublishedAt({elements:u}),this},renderAuthors:function(t){var r=this;return t.elements.forEach(function(t){var i=t.parentElement.getAttribute("data-version-for"),s=void 0;s=i?[r.latest.find(function(e){return new RegExp(e.repo,"i").test(i)}).author]:r.latestGrouped?r.latestGrouped.authors:r.latest.reduce(function(e,t){return e.includes(t.author)?e:[].concat(n(e),[t.author])},[]),t.textContent=e(s)})},renderPublishedAt:function(e){var t=this;return e.elements.forEach(function(e){var n=e.parentElement.getAttribute("data-version-for"),r=void 0;r=n?t.latest.find(function(e){return new RegExp(e.repo,"i").test(n)}).published_at:t.isGrouped()?t.latestGrouped.published_at:t.latest[0].published_at,e.textContent=new Date(r).toDateString()})},renderRepoNames:function(t){var n=this;return t.elements.forEach(function(t){var r=t.parentElement.getAttribute("data-version-for"),i=void 0;if(r){var s=n.latest.find(function(e){return new RegExp(e.repo,"i").test(r)});i=[s.name||s.repo]}else i=n.latest.map(function(e){return e.name||e.repo});t.textContent=e(i)})},renderBadges:function(e){var t=this;e.elements.forEach(function(e){var n=e.parentElement.getAttribute("data-version-for"),r=void 0;r=n?t.latest.find(function(e){return new RegExp(e.repo,"i").test(n)}).version:t.isGrouped()?t.latestGrouped.version:t.latest[0].version||t.latest[0].version,e.textContent=r})},publishedAt:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.repo;if(this.isGrouped())return this.latestGrouped.published_at;if(t){var n=this.latest.find(function(e){return new RegExp(e.repo,"i").test(t)});return n?n.published_at:null}return this.latest[0].published_at},author:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.repo;if(this.isGrouped())return this.latestGrouped.authors;if(t){var n=this.latest.find(function(e){return new RegExp(e.repo,"i").test(t)});return n?n.author:null}return this.latest[0].author},tag:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.repo;if(this.isGrouped())return this.latestGrouped.version;if(t){var n=this.latest.find(function(e){return new RegExp(e.repo,"i").test(t)});return n?n.version:null}return this.latest[0].version},isGrouped:function(){return!!this.latestGrouped}},t.mixin(s),"undefined"!=typeof window&&document.addEventListener("DOMContentLoaded",function(){var e=document.querySelector("script[data-page-id]");if(!e)return console.error("version.js: no key provided");var t=e.getAttribute("data-page-id"),n=e.getAttribute("data-api-key");return window.Version=new s({page:t,apiKey:n}),window.Version.load()}),{}}();
