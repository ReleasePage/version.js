!function(){"use strict";function e(e){var t="";return 1===e.length?t=e[0]:2===e.length?t=e.join(" and "):e.length>2&&(t=e.slice(0,-1).join(", ")+", and "+e.slice(-1)),t}var t=function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)},r=window.__version_base_url||"http://api.releasepage.co",n=window.__help_base_url||"https://help.releasepage.co/api/getting-started",o=function(e){this.options=e};o.prototype={load:function(){var e=this.onLoad.bind(this),t=new XMLHttpRequest;t.addEventListener("load",function(){e({status:this.status,response:this.response})});var n=r+"/v1/pages/"+this.options.page+"/version?apiKey="+this.options.apiKey;t.open("GET",n),t.send()},onLoad:function(e){var t=e.status,r=e.response;switch(t){case 404:return console.error("version.js: A page by name "+this.options.page);case 401:console.error("version.js: enable the version api for this page: "+n);break;case 200:var o=JSON.parse(r);this.latest=o.latest,this.latestGrouped=o.latestGrouped,this.permalink=o.permalink;break;default:return console.error("version.js: ReleasePage API error",t)}var i=document.querySelectorAll("[data-version-badge]");i.length&&this.renderBadges({elements:i});var s=document.querySelectorAll("[data-repo-name]");s.length&&this.renderRepoNames({elements:s});var a=document.querySelectorAll("[data-version-author]");a.length&&this.renderAuthors({elements:a});var u=document.querySelectorAll("[data-version-published]");return u.length&&this.renderPublishedAt({elements:u}),this},renderAuthors:function(r){var n=this;return r.elements.forEach(function(r){var o=r.parentElement.getAttribute("data-version-for"),i=void 0;i=o?[n.latest.find(function(e){return new RegExp(e.repo,"i").test(o)}).author]:n.latestGrouped?n.latestGrouped.authors:n.latest.reduce(function(e,r){return e.includes(r.author)?e:[].concat(t(e),[r.author])},[]),r.textContent=e(i)})},renderPublishedAt:function(e){var t=this;return e.elements.forEach(function(e){var r=e.parentElement.getAttribute("data-version-for"),n=void 0;n=r?t.latest.find(function(e){return new RegExp(e.repo,"i").test(r)}).published_at:t.isGrouped()?t.latestGrouped.published_at:t.latest[0].published_at,e.textContent=new Date(n).toDateString()})},renderRepoNames:function(t){var r=this;return t.elements.forEach(function(t){var n=t.parentElement.getAttribute("data-version-for"),o=void 0;if(n){var i=r.latest.find(function(e){return new RegExp(e.repo,"i").test(n)});o=[i.name||i.repo]}else o=r.latest.map(function(e){return e.name||e.repo});t.textContent=e(o)})},renderBadges:function(e){var t=this;e.elements.forEach(function(e){var r=e.parentElement.getAttribute("data-version-for"),n=void 0;n=r?t.latest.find(function(e){return new RegExp(e.repo,"i").test(r)}).version:t.isGrouped()?t.latestGrouped.version:t.latest[0].version||t.latest[0].version,e.textContent=n})},publishedAt:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.repo;if(this.isGrouped())return this.latestGrouped.published_at;if(t){var r=this.latest.find(function(e){return new RegExp(e.repo,"i").test(t)});return r?r.published_at:null}return this.latest[0].published_at},author:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.repo;if(this.isGrouped())return this.latestGrouped.authors;if(t){var r=this.latest.find(function(e){return new RegExp(e.repo,"i").test(t)});return r?r.author:null}return this.latest[0].author},tag:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.repo;if(this.isGrouped())return this.latestGrouped.version;if(t){var r=this.latest.find(function(e){return new RegExp(e.repo,"i").test(t)});return r?r.version:null}return this.latest[0].version},isGrouped:function(){return!!this.latestGrouped}},"undefined"!=typeof window&&document.addEventListener("DOMContentLoaded",function(){var e=document.querySelector("script[data-page-id]");if(!e)return console.error("version.js: no key provided");var t=e.getAttribute("data-page-id"),r=e.getAttribute("data-api-key");return window.Version=new o({page:t,apiKey:r}),window.Version.load()})}();
