var Version=function(){"use strict";function e(e,t){return t={exports:{}},e(t,t.exports),t.exports}var t=e(function(e){var t=function(){};t.prototype={bind:function(e,t){this._events=this._events||{},this._events[e]=this._events[e]||[],this._events[e].push(t)},unbind:function(e,t){this._events=this._events||{},e in this._events!=!1&&this._events[e].splice(this._events[e].indexOf(t),1)},trigger:function(e){if(this._events=this._events||{},e in this._events!=!1)for(var t=0;t<this._events[e].length;t++)this._events[e][t].apply(this,Array.prototype.slice.call(arguments,1))}},t.mixin=function(e){for(var n=["bind","unbind","trigger"],r=0;r<n.length;r++)e.prototype[n[r]]=t.prototype[n[r]]},"exports"in e&&(e.exports=t)}),n=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)};return e(function(e){function r(e){var t="";return 1===e.length?t=e[0]:2===e.length?t=e.join(" and "):e.length>2&&(t=e.slice(0,-1).join(", ")+", and "+e.slice(-1)),t}var i=window&&window.__version_base_url||"http://api.releasepage.co",s=window&&window.__help_base_url||"https://help.releasepage.co/api/getting-started",o=function(e){var t=this;this.opts=e,this.bind("load",function(){return t.render()})};o.prototype={options:function(e){return this.opts=e,this},load:function(){this.opts.apiKey||console.error("version.js: no key provided"),this.opts.pageId||console.error("version.js: no pageId provided");var e=this.onLoad.bind(this),t=new XMLHttpRequest;t.addEventListener("load",function(){e({status:this.status,response:this.response})});var n=i+"/v1/pages/"+this.opts.pageId+"/version?apiKey="+this.opts.apiKey;t.open("GET",n),t.send()},onLoad:function(e){var t=e.status,n=e.response;switch(t){case 404:return console.error("version.js: A Release Page with id "+this.opts.pageId+" does not exist");case 401:console.error("version.js: enable the version api for this Release Page: "+s);break;case 200:var r=JSON.parse(n);this.latest=r.latest,this.latestGrouped=r.latestGrouped,this.permalink=r.permalink;break;default:return console.error("version.js: ReleasePage API error",t)}return this.trigger("load")},render:function(){var e=document.querySelectorAll("[data-version-badge]");e.length&&this.renderBadges({elements:e});var t=document.querySelectorAll("[data-repo-name]");t.length&&this.renderRepoNames({elements:t});var n=document.querySelectorAll("[data-version-author]");n.length&&this.renderAuthors({elements:n});var r=document.querySelectorAll("[data-version-published]");return r.length&&this.renderPublishedAt({elements:r}),this},renderAuthors:function(e){var t=this;return e.elements.forEach(function(e){var i=e.parentElement.getAttribute("data-version-for"),s=void 0;s=i?[t.latest.find(function(e){return new RegExp(e.repo,"i").test(i)}).author]:t.latestGrouped?t.latestGrouped.authors:t.latest.reduce(function(e,t){return e.includes(t.author)?e:[].concat(n(e),[t.author])},[]),e.textContent=r(s)})},renderPublishedAt:function(e){var t=this;return e.elements.forEach(function(e){var n=e.parentElement.getAttribute("data-version-for"),r=void 0;r=n?t.latest.find(function(e){return new RegExp(e.repo,"i").test(n)}).published_at:t.isGrouped()?t.latestGrouped.published_at:t.latest[0].published_at,e.textContent=new Date(r).toDateString()})},renderRepoNames:function(e){var t=this;return e.elements.forEach(function(e){var n=e.parentElement.getAttribute("data-version-for"),i=void 0;if(n){var s=t.latest.find(function(e){return new RegExp(e.repo,"i").test(n)});i=[s.name||s.repo]}else i=t.latest.map(function(e){return e.name||e.repo});e.textContent=r(i)})},renderBadges:function(e){var t=this;e.elements.forEach(function(e){var n=e.parentElement.getAttribute("data-version-for"),r=void 0;r=n?t.latest.find(function(e){return new RegExp(e.repo,"i").test(n)}).version:t.isGrouped()?t.latestGrouped.version:t.latest[0].version||t.latest[0].version,e.textContent=r})},publishedAt:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.repo;if(this.isGrouped())return this.latestGrouped.published_at;if(t){var n=this.latest.find(function(e){return new RegExp(e.repo,"i").test(t)});return n?n.published_at:null}return this.latest[0].published_at},author:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.repo;if(this.isGrouped())return this.latestGrouped.authors;if(t){var n=this.latest.find(function(e){return new RegExp(e.repo,"i").test(t)});return n?n.author:null}return this.latest[0].author},tag:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.repo;if(window&&window.__debug_version)return window.__debug_version;if(this.isGrouped())return this.latestGrouped.version;if(t){var n=this.latest.find(function(e){return new RegExp(e.repo,"i").test(t)});return n?n.version:null}return this.latest[0].version},isGrouped:function(){return!!this.latestGrouped}},t.mixin(o);var a=void 0,u=document.querySelector("script[data-page-id]");if(u){var d=u.getAttribute("data-page-id"),l=u.getAttribute("data-api-key");a=new o({pageId:d,apiKey:l})}else a=new o;e&&(e.exports=a),"undefined"!=typeof window&&(window.version=a,document.addEventListener("DOMContentLoaded",function(){a.load()}))})}();
